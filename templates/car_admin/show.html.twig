{% extends 'base.html.twig' %}

{% block content_body %}
    <h1>{{ car.name }}</h1>

    <div>
        <table>
            <tr>
                <td>Mileage: </td><td>{{ car.mileage}} {{ car.milageUnit }}</td>
            </tr>
        </table>
    </div>

    <div>
        <button type="link" class="btn btn-primary" onclick="location.href='/admin/calendar';">Show calendar <span class="fa-solid fa-calendar"></span></button>
        <button type="link" class="btn btn-primary" onclick="location.href='{{ path('app_trip_new',  {car: car.id}) }}';">Add trip <span class="fa fa-plus-circle"></span></button>
        <button type="link" class="btn btn-primary" onclick="location.href='/admin/expense/new/{{ car.id }}';">Add expense <span class="fa fa-plus-circle"></span></button>
        <button type="link" class="btn btn-primary" onclick="location.href='/admin/user/invite/{{ car.id }}';">Invite User <span class="fa fa-plus-circle"></span></button>
    </div>
    <div>
        <h2>Trips</h2>
        <table class="table">
            <thead>
                <tr>
                    <th>User</th>
                    <th>Start Date</th>
                    <th>Start Mileage</th>
                    <th>End Date</th>
                    <th>End Mileage</th>
                    <th>Type</th>
                    <th>Costs</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for trip in trips %}
                    <tr>
                        <td>{{ trip.user.name }}</td>
                        <td>{{ trip.startDate|date('d.m.Y') }}</td>
                        <td>{{ trip.startMileage }}</td>
                        <td>{{ trip.endDate|date('d.m.Y') }}</td>
                        <td>{{ trip.endMileAge }}</td>
                        <td>{{ trip.type }}</td>
                        <td>{{ trip.costs|format_currency('EUR', locale='de')}}</td>
                        <td>
                        {% if loop.last %}
                            <a href='{{ path('app_trip_delete', {trip: trip.id}) }}'><i class="fas fa-trash"></i></a>
                            <a href='{{ path('app_trip_edit', {trip: trip.id}) }}'><i class="fas fa-edit"></i></a>
                        {% endif %}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div>
        <h2>Expenses</h2>
        <table class="table">
            <thead>
                <tr>
                    <th>User</th>
                    <th>Date</th>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Amount</th>
                    <th>Comment</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for expense in expenses %}
                    <tr>
                        <td>{{ expense.user.name }}</td>
                        <td>{{ expense.date|date('d.m.Y') }}</td>
                        <td>{{ expense.type }}</td>
                        <td>{{ expense.name}}</td>
                        <td>{{ expense.amount|format_currency('EUR', locale='de')}}</td>
                        <td>{{ expense.comment }}</td>
                        <td>
                            <a href='{{ path('app_expense_delete', {expense: expense.id}) }}'><i class="fas fa-trash"></i></a>
                            <a href='{{ path('app_expense_edit', {expense: expense.id}) }}'><i class="fas fa-edit"></i></a>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}